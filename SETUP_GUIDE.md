# セットアップガイド 📖

このガイドに従って、出退勤打刻アプリをセットアップしてください。

## ⏱️ 所要時間: 約30分

---

## ステップ1: Google Spreadsheetの準備 (5分)

### 1-1. 新しいスプレッドシートを作成

1. [Google Spreadsheet](https://sheets.google.com/)にアクセス
2. 「空白」をクリックして新しいスプレッドシートを作成
3. 名前を「出退勤管理」に変更

### 1-2. シートの準備

スプレッドシートには以下の3つのシートが自動作成されます（GASで自動生成）:
- 研修生マスタ
- 打刻記録
- 課題完了記録

**注意**: シートの手動作成は不要です。GASが自動で作成します。

---

## ステップ2: Google Apps Scriptのデプロイ (10分)

### 2-1. Apps Scriptエディタを開く

1. スプレッドシートで「拡張機能」→「Apps Script」をクリック
2. 新しいタブでApps Scriptエディタが開きます

### 2-2. コードをコピー

1. プロジェクトの`Code.gs`ファイルを開く
2. 内容をすべてコピー
3. Apps Scriptエディタの`Code.gs`に貼り付け（既存のコードは削除）

### 2-3. 初期セットアップを実行

1. 関数選択ドロップダウンで`setupSpreadsheet`を選択
2. 「実行」ボタン（▶️）をクリック
3. 初回実行時、権限の確認が表示されます:
   - 「権限を確認」をクリック
   - Googleアカウントを選択
   - 「詳細」→「（プロジェクト名）に移動（安全ではありません）」をクリック
   - 「許可」をクリック
4. 実行が完了したら、スプレッドシートに戻って3つのシートが作成されたことを確認

### 2-4. 研修生情報を登録

1. 「研修生マスタ」シートを開く
2. 2行目のデータを編集:
   - 研修生ID: `user01`（変更不要）
   - 氏名: **あなたの名前を入力**
   - ステータス: `進行中`（変更不要）

### 2-5. ウェブアプリとしてデプロイ

1. Apps Scriptエディタに戻る
2. 右上の「デプロイ」→「新しいデプロイ」をクリック
3. 「種類の選択」（歯車アイコン）をクリック
4. 「ウェブアプリ」を選択
5. 設定を入力:
   - 説明: `出退勤打刻API`
   - 次のユーザーとして実行: `自分`
   - アクセスできるユーザー: `全員`
6. 「デプロイ」をクリック
7. **ウェブアプリのURL**をコピーして保存（後で使います）
   - 例: `https://script.google.com/macros/s/XXXXX.../exec`

---

## ステップ3: アプリの設定 (5分)

### 3-1. app.jsを編集

1. プロジェクトの`app.js`ファイルを開く
2. `CONFIG`オブジェクトを見つける（ファイルの先頭付近）
3. 以下のように編集:

```javascript
const CONFIG = {
    GAS_URL: 'https://script.google.com/macros/s/XXXXX.../exec', // ← ステップ2-5でコピーしたURLに置き換え
    USER_ID: 'user01',
    APP_URL: 'https://YOUR_GITHUB_USERNAME.github.io/attendance-app' // ← あとで更新します
};
```

---

## ステップ4: GitHubリポジトリの作成 (5分)

### 4-1. GitHubで新しいリポジトリを作成

1. [GitHub](https://github.com)にログイン
2. 右上の「+」→「New repository」をクリック
3. リポジトリ情報を入力:
   - Repository name: `attendance-app`
   - Description: `出退勤打刻アプリ - 研修課題5`
   - Public（公開）を選択
   - **他のオプションはチェックしない**
4. 「Create repository」をクリック

### 4-2. ローカルリポジトリをプッシュ

プロジェクトディレクトリで以下のコマンドを実行:

```bash
# Gitの初期化（まだの場合）
git init

# 全ファイルをステージング
git add .

# コミット
git commit -m "Initial commit: 出退勤打刻アプリ"

# メインブランチに変更
git branch -M main

# リモートリポジトリを追加（YOUR_USERNAMEを自分のユーザー名に変更）
git remote add origin https://github.com/YOUR_USERNAME/attendance-app.git

# プッシュ
git push -u origin main
```

---

## ステップ5: GitHub Pagesの有効化 (3分)

### 5-1. GitHub Pagesを設定

1. GitHubのリポジトリページに移動
2. 「Settings」タブをクリック
3. 左サイドバーの「Pages」をクリック
4. Source設定:
   - Branch: `main`を選択
   - Folder: `/ (root)`を選択
5. 「Save」をクリック
6. 数分待つと、緑色のバーに **デプロイURL** が表示されます
   - 例: `https://YOUR_USERNAME.github.io/attendance-app`

### 5-2. APP_URLを更新

1. `app.js`の`CONFIG.APP_URL`をデプロイURLに更新
2. 変更をコミット&プッシュ:

```bash
git add app.js
git commit -m "Update: APP_URLを設定"
git push
```

---

## ステップ6: 動作確認 (2分)

### 6-1. アプリにアクセス

1. ブラウザで`https://YOUR_USERNAME.github.io/attendance-app`を開く
2. ページが正しく表示されることを確認

### 6-2. 出勤打刻をテスト

1. 「出勤」ボタンをクリック
2. 確認ダイアログで「OK」をクリック
3. 「出勤打刻が完了しました！」のトースト通知が表示される
4. LINEグループに通知が届くことを確認
5. スプレッドシートの「打刻記録」シートに記録されることを確認

### 6-3. 退勤打刻をテスト

1. 「退勤」ボタンをクリック
2. 確認ダイアログで「OK」をクリック
3. 「退勤打刻が完了しました！」のトースト通知が表示される
4. 勤務時間が自動計算されて表示される
5. LINEグループに通知が届くことを確認

---

## ステップ7: PWAとしてインストール (オプション)

### iOSの場合

1. Safariでアプリを開く
2. 画面下部の共有ボタン（□↑）をタップ
3. 「ホーム画面に追加」を選択
4. 「追加」をタップ

### Androidの場合

1. Chromeでアプリを開く
2. 画面右上のメニュー（⋮）をタップ
3. 「ホーム画面に追加」を選択
4. 「追加」をタップ

---

## ステップ8: 課題完了報告 🎉

すべての動作確認が完了したら:

1. アプリで「🎉課題完了報告」ボタンをクリック
2. 確認ダイアログで「OK」をクリック
3. LINEグループに課題完了の通知が届きます
4. 管理者が確認して、合格判定を行います

---

## 🔧 トラブルシューティング

### Q1: 「初期化に失敗しました」と表示される

**A**: `app.js`の`GAS_URL`が正しく設定されているか確認してください。

1. GASのデプロイURLをコピー
2. `app.js`の`CONFIG.GAS_URL`に貼り付け
3. 変更をコミット&プッシュ

### Q2: LINE通知が届かない

**A**: LINEの設定を確認してください。

1. `Code.gs`のLINEチャネルアクセストークンが正しいか確認
2. グループIDが正しいか確認
3. LINE Messaging APIのチャネルが有効か確認

### Q3: スプレッドシートに記録されない

**A**: GASの権限を確認してください。

1. Apps Scriptエディタで「実行」→「setupSpreadsheet」を再実行
2. 権限を再度付与

### Q4: 「出勤打刻済みです」と表示される

**A**: 本日の出勤記録が既に存在しています。

1. スプレッドシートの「打刻記録」シートを確認
2. テストの場合は該当行を削除

---

## 📞 サポート

問題が解決しない場合は、以下を管理者に報告してください:

1. エラーメッセージのスクリーンショット
2. ブラウザの開発者コンソールのエラーログ
3. GAS実行ログ（Apps Scriptエディタ → 表示 → ログ）

---

## ✅ セットアップ完了チェックリスト

- [ ] Google Spreadsheetを作成した
- [ ] GASをデプロイした
- [ ] 研修生マスタに自分の名前を登録した
- [ ] app.jsにGAS URLを設定した
- [ ] GitHubリポジトリを作成した
- [ ] GitHub Pagesでデプロイした
- [ ] app.jsにAPP URLを設定した
- [ ] 出勤打刻が動作した
- [ ] 退勤打刻が動作した
- [ ] LINE通知が届いた
- [ ] スプレッドシートに記録された
- [ ] PWAとしてインストールできた

すべてチェックが付いたら、「🎉課題完了報告」ボタンを押しましょう！

頑張ってください！ 💪
